<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Selenium 自動化測試 | Nalson</title><meta name="author" content="Nalson Lai"><meta name="copyright" content="Nalson Lai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="這篇是記錄我在看鐵人賽 Python 與自動化測試的敲門磚  的過程 套件安裝selenium：用來建立模擬器webdriver_manager：用來協助我們做驅動程式的安裝，可以無需實際下載瀏覽器的驅動程式 12pip install seleniumpip install webdriver_manager  快速入門程式解析： 透過 make_webdriver 內的程式碼，可以建立一個 C">
<meta property="og:type" content="article">
<meta property="og:title" content="Selenium 自動化測試">
<meta property="og:url" content="https://gahgah147.github.io/2023/10/03/Selenium-%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6/index.html">
<meta property="og:site_name" content="Nalson">
<meta property="og:description" content="這篇是記錄我在看鐵人賽 Python 與自動化測試的敲門磚  的過程 套件安裝selenium：用來建立模擬器webdriver_manager：用來協助我們做驅動程式的安裝，可以無需實際下載瀏覽器的驅動程式 12pip install seleniumpip install webdriver_manager  快速入門程式解析： 透過 make_webdriver 內的程式碼，可以建立一個 C">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://gahgah147.github.io/img/catchorange.png">
<meta property="article:published_time" content="2023-10-03T03:49:28.000Z">
<meta property="article:modified_time" content="2024-10-29T03:54:51.444Z">
<meta property="article:author" content="Nalson Lai">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="自動化測試">
<meta property="article:tag" content="Selenium">
<meta property="article:tag" content="XPATH">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gahgah147.github.io/img/catchorange.png"><link rel="shortcut icon" href="/img/catchorange.png"><link rel="canonical" href="https://gahgah147.github.io/2023/10/03/Selenium-%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.1.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到符合您查詢的內容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '複製成功',
    error: '複製失敗',
    noSupport: '瀏覽器不支援'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '剛剛',
    min: '分鐘前',
    hour: '小時前',
    day: '天前',
    month: '個月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '載入更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Selenium 自動化測試',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-29 11:54:51'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Nalson" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="Nalson" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/catchorange.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">134</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">215</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 歸檔</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情連結</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-info"></i><span> 關於</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/back_img.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Nalson</span></a><a class="nav-page-title" href="/"><span class="site-name">Selenium 自動化測試</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜尋</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 歸檔</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情連結</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-info"></i><span> 關於</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Selenium 自動化測試</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" datetime="2023-10-03T03:49:28.000Z" title="發表於 2023-10-03 11:49:28">2023-10-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" datetime="2024-10-29T03:54:51.444Z" title="更新於 2024-10-29 11:54:51">2024-10-29</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">瀏覽量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>這篇是記錄我在看鐵人賽 <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10290529">Python 與自動化測試的敲門磚 </a> 的過程</p>
<h1 id="套件安裝"><a href="#套件安裝" class="headerlink" title="套件安裝"></a>套件安裝</h1><p>selenium：用來建立模擬器<br>webdriver_manager：用來協助我們做驅動程式的安裝，可以無需實際下載瀏覽器的驅動程式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium</span><br><span class="line">pip install webdriver_manager</span><br></pre></td></tr></table></figure>

<h1 id="快速入門"><a href="#快速入門" class="headerlink" title="快速入門"></a>快速入門</h1><p>程式解析：</p>
<p>透過 make_webdriver 內的程式碼，可以建立一個 Chrome 物件，習慣上我們會將此物件命名為 driver<br>透過實作該方法得到 driver<br>透過 driver.get() 對網址進行請求，這個時候 driver 就會實際替我們開啟一個瀏覽器<br>為了展示開啟成功，使用 time.sleep() 讓瀏覽器畫面停止一下<br>使用 driver.quit() 來確保瀏覽器完全關閉，不會殘留在記憶體當中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from webdriver_manager.chrome import ChromeDriverManager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def make_webdriver() -&gt; Chrome:</span><br><span class="line">    driver = Chrome(ChromeDriverManager().install())</span><br><span class="line"></span><br><span class="line">    return driver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    url = &quot;https://ithelp.ithome.com.tw/questions&quot;</span><br><span class="line">    _driver = make_webdriver()</span><br><span class="line">    </span><br><span class="line">    _driver.get(url=url)</span><br><span class="line">    time.sleep(10)</span><br><span class="line">    </span><br><span class="line">    _driver.quit()</span><br></pre></td></tr></table></figure>

<p>成果展示：</p>
<p>可以看到下圖當中，透過 selenium 開啟的瀏覽器上方會有註明受到測試軟體控制</p>
<h1 id="加上參數"><a href="#加上參數" class="headerlink" title="加上參數"></a>加上參數</h1><p>我們可以透過加上一些參數，來設定瀏覽器開啟時的相關設定，下方直接透過程式講解<br>程式解析：</p>
<p>import Options 這個 class<br>於 function 內實作此 class<br>透過 add_argument 加入參數<br>–headless：讓瀏覽器進入無頭模式，簡單來說就是放在背景運行，不會實際開一個視窗出來<br>–start-maximized：確保瀏覽器每次執行時都可以開到最大的視窗，避免 RWD 造成一些元素讀不到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line"></span><br><span class="line">def create_options() -&gt; Options:</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_argument(&quot;--headless&quot;)</span><br><span class="line">    options.add_argument(&quot;--start-maximized&quot;)</span><br><span class="line"></span><br><span class="line">    return options</span><br></pre></td></tr></table></figure>
<p>完整程式碼：<br>透過在 driver 中添加 options 參數，我們即可為 driver 做一些瀏覽器的設定</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">from webdriver_manager.chrome import ChromeDriverManager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def make_webdriver() -&gt; Chrome:</span><br><span class="line">    options = create_options()</span><br><span class="line">    driver = Chrome(ChromeDriverManager().install(),</span><br><span class="line">                    options=options)</span><br><span class="line"></span><br><span class="line">    return driver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def create_options() -&gt; Options:</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_argument(&quot;--headless&quot;)</span><br><span class="line">    options.add_argument(&quot;--start-maximized&quot;)</span><br><span class="line"></span><br><span class="line">    return options</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    url = &quot;https://ithelp.ithome.com.tw/questions&quot;</span><br><span class="line">    _driver = make_webdriver()</span><br><span class="line"></span><br><span class="line">    _driver.get(url=url)</span><br><span class="line"></span><br><span class="line">    _driver.quit()</span><br></pre></td></tr></table></figure>

<h1 id="搭配-fixture"><a href="#搭配-fixture" class="headerlink" title="搭配 fixture"></a>搭配 fixture</h1><p>在撰寫測試程式的時候，driver 就特別適合撰寫成 fixture 來進行使用，下面也是直接附上範例</p>
<p>程式解析：</p>
<p>建立一個 fixture 並命名為 driver<br>建立 options<br>建立 driver 並指派 options 參數<br>透過 yield 將 driver 回傳出去<br>測試程式結束後回到 fixture 內執行 driver.quit() 退出 driver</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">from webdriver_manager.chrome import ChromeDriverManager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@pytest.fixture(name=&quot;driver&quot;)</span><br><span class="line">def driver_fixture() -&gt; Chrome:</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_argument(&quot;--headless&quot;)</span><br><span class="line">    options.add_argument(&quot;--start-maximized&quot;)</span><br><span class="line"></span><br><span class="line">    driver = Chrome(ChromeDriverManager().install(),</span><br><span class="line">                    options=options)</span><br><span class="line"></span><br><span class="line">    yield driver</span><br><span class="line"></span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure>

<h1 id="建立-driver-函式"><a href="#建立-driver-函式" class="headerlink" title="建立 driver 函式"></a>建立 driver 函式</h1><p>首先我們先建立一個通用的可以回傳 driver 的函式，這個部份我們昨天介紹過了，今天就直接上範例方便大家對應函式名稱</p>
<p>本次進行範例說明所請求的網址為 PTT 熱門版，下方範例中有附上網址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">from webdriver_manager.chrome import ChromeDriverManager</span><br><span class="line"></span><br><span class="line">url = &quot;https://www.ptt.cc/bbs/index.html&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def make_chrome_driver() -&gt; Chrome:</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_argument(&quot;--headless&quot;)</span><br><span class="line">    options.add_argument(&quot;--start-maximized&quot;)</span><br><span class="line"></span><br><span class="line">    driver = Chrome(ChromeDriverManager().install(),</span><br><span class="line">                    options=options)</span><br><span class="line">    return driver</span><br></pre></td></tr></table></figure>

<h1 id="使用-CSS-SELECTOR-定位"><a href="#使用-CSS-SELECTOR-定位" class="headerlink" title="使用 CSS_SELECTOR 定位"></a>使用 CSS_SELECTOR 定位</h1><p>Selenium 的官方文件中，提供了許多種定位 HTML 元素的方式，今天我們就挑兩種比較常用的來進行介紹，首先我們先介紹 CSS_SELECTOR</p>
<p>CSS_SELECTOR 語法：&lt;html 元素名稱&gt;&lt;CSS 名稱&gt;，其中 CSS 名稱可以是複數個，下面附上使用範例，至於該如何取得 CSS，我們可以透過在網頁上按又鍵開啟 “檢查” 選項來進行查看</p>
<p>程式解析：</p>
<p>取得 driver 並進行請求<br>使用 driver.find_element 來尋找元素，並指定使用 CSS_SELECTOR 進行尋找，第二個參數為 CSS 條件<br>印出該元素的資訊<br>使用 driver.find_elements 尋找所有在葉面上已出現並符合 CSS 條件的資訊<br>透過 generator 的方式來印出所有元素的文字資訊<br>補充說明：<br>每一個透過 selenium 找到的元素都一定有 text 屬性以及 get_attribute() 方法，其中 text 會印出該元素下所有的文字資訊，get_attribute() 則可以該元素的相關資訊，例如：class、href … 等等，下方的範例為取得 text</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line"></span><br><span class="line">def demo_css_selector():</span><br><span class="line">    driver = make_chrome_driver()</span><br><span class="line">    driver.get(url=url)</span><br><span class="line">    </span><br><span class="line">    # 回傳最先找到的元素，若沒有找到則會跳 error</span><br><span class="line">    data = driver.find_element(By.CSS_SELECTOR, &quot;div.b-ent&quot;).text</span><br><span class="line">    print(data)</span><br><span class="line">    </span><br><span class="line">    # 會尋找目前葉面當中所有符合條件的元素，並回傳一個 list，若沒找到會回傳一個空 list</span><br><span class="line">    datas = driver.find_elements(By.CSS_SELECTOR, &quot;div.b-ent&quot;)</span><br><span class="line">    [print(tmp.text) for tmp in datas]</span><br></pre></td></tr></table></figure>

<h1 id="使用-XPATH-定位"><a href="#使用-XPATH-定位" class="headerlink" title="使用 XPATH 定位"></a>使用 XPATH 定位</h1><p>接下來的範例當中，我們會使用 XPATH 的方式尋找元素，並使用 get_attribute() 來取得該元素的 class</p>
<p>補充：我們同樣可以透過 “檢查” 來複製該元素在網頁上的 XPATH</p>
<p>在 “檢查” 當中找到該元素<br>對該元素點選右鍵，選取 “複製” -&gt; “複製 XPATH” or “複製完整 XPATH”<br>至於 XPATH 的使用方式則不是本次重點，之後可以在鐵人賽後找時間進行說明</p>
<p>程式解析：<br>運作邏輯基本上一樣，只是 By.CSS_SELECTOR 更換成 By.XPATH，並搭配 XPATH 條件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def demo_xpath():</span><br><span class="line">    driver = make_chrome_driver()</span><br><span class="line">    driver.get(url=url)</span><br><span class="line"></span><br><span class="line">    data = driver.find_element(By.XPATH, &quot;//*[@id=&#x27;main-container&#x27;]/div[2]/div[1]&quot;)</span><br><span class="line">    print(data.get_attribute(&quot;class&quot;))</span><br><span class="line"></span><br><span class="line">    datas = driver.find_elements(By.XPATH, &quot;//*[@id=&#x27;main-container&#x27;]/div[2]/div&quot;)</span><br><span class="line">    [print(tmp.get_attribute(&quot;class&quot;)) for tmp in datas]</span><br></pre></td></tr></table></figure>
<h1 id="等待元素出現"><a href="#等待元素出現" class="headerlink" title="等待元素出現"></a>等待元素出現</h1><p>由於 selenium 是實際開啟一個瀏覽器來進行請求，因此會受限於各種情況導致元素會比較慢出現，因此 selenium 提供了一種等待元素的方式，下面附上使用範例</p>
<p>程式解析：</p>
<p>透過 WebDriverWait 進行元素的等待，告訴 Selenium 等待該元素 10 秒，當元素在 10 秒內出現，則會繼續進行下一段程式，但是超過 10 秒還沒出現，則會拋出 Timeout 錯誤<br>ec.presence_of_element_located 則表示要去尋找目前出現在畫面上的元素，和下方的 of_all 差別為單數之分，用法同 find_element</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.support.ui import WebDriverWait</span><br><span class="line">from selenium.webdriver.support import expected_conditions as ec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def demo_wait():</span><br><span class="line">    driver = make_chrome_driver()</span><br><span class="line">    driver.get(url=url)</span><br><span class="line">    </span><br><span class="line">    # 單個元素，回傳 webelement 物件</span><br><span class="line">    data = WebDriverWait(driver, 10).until(</span><br><span class="line">        ec.presence_of_element_located((By.CSS_SELECTOR, &quot;div.b-ent&quot;)))</span><br><span class="line">    print(data.text)</span><br><span class="line">    </span><br><span class="line">    # 多個元素，回傳 list</span><br><span class="line">    datas = WebDriverWait(driver, 10).until(</span><br><span class="line">        ec.presence_of_all_elements_located((By.CSS_SELECTOR, &quot;div.b-ent&quot;)))</span><br><span class="line">    [print(tmp.text) for tmp in datas]</span><br></pre></td></tr></table></figure>

<h1 id="建立-driver-函式-1"><a href="#建立-driver-函式-1" class="headerlink" title="建立 driver 函式"></a>建立 driver 函式</h1><p>同樣的我們今天一樣先附上建立 driver 的函式，今天比較不一樣的地方是，我們透過 contextmanager 來建立，<br>這樣我們就可以透過 yield 以及 with 的方式來操作 driver，並於操作結束後會自動回到此函式內執行 driver.quit()，以此確保瀏覽器會被完全關閉，不殘留在記憶體當中</p>
<p>另外我們今天爬取的目標是 ithelp，因此代入 user-agent 以免被誤認為是機器人而造成範例失敗，理論上如果是拿來測試網頁的話，應該是不用帶入這個參數的，不過還是要視情況而定</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from contextlib import contextmanager</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from webdriver_manager.chrome import ChromeDriverManager</span><br><span class="line"></span><br><span class="line">@contextmanager</span><br><span class="line">def make_chrome_driver() -&gt; Chrome:</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_argument(&quot;--headless&quot;)</span><br><span class="line">    options.add_argument(&quot;--start-maximized&quot;)</span><br><span class="line">    options.add_argument(f&quot;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) &quot;</span><br><span class="line">                         f&quot;AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36&quot;)</span><br><span class="line"></span><br><span class="line">    driver = Chrome(ChromeDriverManager().install(),</span><br><span class="line">                    options=options)</span><br><span class="line">    yield driver</span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure>

<h1 id="取得基本資訊"><a href="#取得基本資訊" class="headerlink" title="取得基本資訊"></a>取得基本資訊</h1><p>我們可以透過 driver 物件本身取得一些瀏覽器的資訊，下面列舉三點並附上程式碼做參考：</p>
<p>driver.current_url：取得瀏覽器目前所在頁面的網址<br>driver.title：取得瀏覽器目前所在頁面的 title，就是我們可以在瀏覽器最上方看到的分頁的名稱<br>driver.page_source：取得瀏覽器目前所在頁面的 HTML Code，取得後可透過 BeautifulSoup 進行網頁解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def demo_basic_info():</span><br><span class="line">    with make_chrome_driver() as driver:</span><br><span class="line">        driver.get(&quot;https://ithelp.ithome.com.tw/&quot;)</span><br><span class="line"></span><br><span class="line">        # 取得目前頁面的網址</span><br><span class="line">        current_url = driver.current_url</span><br><span class="line">        print(current_url)</span><br><span class="line"></span><br><span class="line">        # 取得目前頁面的 title</span><br><span class="line">        current_title = driver.title</span><br><span class="line">        print(current_title)</span><br><span class="line"></span><br><span class="line">        # 取得目前頁面的 HTML Code</span><br><span class="line">        current_code = driver.page_source</span><br><span class="line">        print(current_code)</span><br></pre></td></tr></table></figure>

<h1 id="點選元素"><a href="#點選元素" class="headerlink" title="點選元素"></a>點選元素</h1><p>在 selenium 當中點選元素的方式有兩種，分別為透過 selenium 找到元素後進行點選以及找到元素後透過執行 javascript 進行點選，後者通常用於當要被點選的按鈕被某個跳出視窗遮住，或是畫面上被隱藏但是 HTML Code 實際上是存在時，我們就可以透過執行 javascript 直接對其進行點選的動作</p>
<h2 id="使用-Selenium-點選"><a href="#使用-Selenium-點選" class="headerlink" title="使用 Selenium 點選"></a>使用 Selenium 點選</h2><p>程式解析：</p>
<p>利用 selenium 找到 “技術文章” 按鈕元素<br>透過呼叫元素當中的 click() 方法即代表使用 selenium 內建的方式進行點選<br>點選該元素後頁面會進行跳轉，於點選後透過 driver.current_url 來取得該頁面網址<br>驗證取得的網址是否如同預期該出現的網址內容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">from selenium.webdriver.support.ui import WebDriverWait</span><br><span class="line">from selenium.webdriver.support import expected_conditions as ec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def demo_click_by_selenium():</span><br><span class="line">    with make_chrome_driver() as driver:</span><br><span class="line">        driver.get(&quot;https://ithelp.ithome.com.tw/&quot;)</span><br><span class="line">        technical_article_button = WebDriverWait(driver, 30).until(</span><br><span class="line">            ec.presence_of_element_located((By.XPATH, &quot;/html/body/div[1]/nav/div[1]/div/ul[1]/li[2]/a&quot;)))</span><br><span class="line"></span><br><span class="line">        # click by selenium</span><br><span class="line">        technical_article_button.click()</span><br><span class="line"></span><br><span class="line">        technical_article_url = &quot;https://ithelp.ithome.com.tw/articles?tab=tech&quot;</span><br><span class="line">        current_url = driver.current_url</span><br><span class="line"></span><br><span class="line">        assert current_url == technical_article_url</span><br></pre></td></tr></table></figure>

<h2 id="使用-Javascript-點選"><a href="#使用-Javascript-點選" class="headerlink" title="使用 Javascript 點選"></a>使用 Javascript 點選</h2><p>語法：driver.execute_script(“arguments[0].click();”, &lt;元素名稱&gt;)</p>
<p>程式解析：<br>運作邏輯基本同上面一樣，差別只在於透過 javascript 執行點選的部分，有特別使用註解標記</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">from selenium.webdriver.support.ui import WebDriverWait</span><br><span class="line">from selenium.webdriver.support import expected_conditions as ec</span><br><span class="line"></span><br><span class="line">def demo_click_by_javascript():</span><br><span class="line">    with make_chrome_driver() as driver:</span><br><span class="line">        driver.get(&quot;https://ithelp.ithome.com.tw/&quot;)</span><br><span class="line">        technical_article_button = WebDriverWait(driver, 30).until(</span><br><span class="line">            ec.presence_of_element_located((By.XPATH, &quot;/html/body/div[1]/nav/div[1]/div/ul[1]/li[2]/a&quot;)))</span><br><span class="line"></span><br><span class="line">        # click by js</span><br><span class="line">        driver.execute_script(&quot;arguments[0].click();&quot;, technical_article_button)</span><br><span class="line"></span><br><span class="line">        technical_article_url = &quot;https://ithelp.ithome.com.tw/articles?tab=tech&quot;</span><br><span class="line">        current_url = driver.current_url</span><br><span class="line"></span><br><span class="line">        assert current_url == technical_article_url</span><br></pre></td></tr></table></figure>

<h1 id="鍵盤操作"><a href="#鍵盤操作" class="headerlink" title="鍵盤操作"></a>鍵盤操作</h1><p>在 selenium 當中，我們可以透過 send_keys() 方法來對元素進行文字的輸入，另外也可以透過 selenium 提供的 Keys 類別來模擬鍵盤的操作，下面的範例當中我們就分別使用上述兩種方法來進行帳號密碼的輸入，並用 Enter 鍵進行確認</p>
<p>程式解析：</p>
<ul>
<li>先分別透過 selenium 找到輸入帳號、密碼的元素</li>
<li>利用 send_keys() 輸入帳號及密碼</li>
<li>輸入完成後於 password 利用 Keys 模擬 Enter 鍵的操作進行確認以及頁面跳轉</li>
<li>於跳轉後，取得 user name 並進行驗證</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">from selenium.webdriver.support.ui import WebDriverWait</span><br><span class="line">from selenium.webdriver.support import expected_conditions as ec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def demo_input_keyboard():</span><br><span class="line">    with make_chrome_driver() as driver:</span><br><span class="line">        driver.get(&quot;https://member.ithome.com.tw/login&quot;)</span><br><span class="line">        account = WebDriverWait(driver, 30).until(ec.presence_of_element_located((By.XPATH, &quot;//*[@id=&#x27;account&#x27;]&quot;)))</span><br><span class="line">        password = WebDriverWait(driver, 30).until(ec.presence_of_element_located((By.XPATH, &quot;//*[@id=&#x27;password&#x27;]&quot;)))</span><br><span class="line"></span><br><span class="line">        account.send_keys(&quot;&lt;你的帳號&gt;&quot;)</span><br><span class="line">        password.send_keys(&quot;&lt;你的密碼&gt;&quot;)</span><br><span class="line">        password.send_keys(Keys.ENTER)</span><br><span class="line"></span><br><span class="line">        user_name = WebDriverWait(driver, 30).until(</span><br><span class="line">            ec.presence_of_element_located((By.XPATH, &quot;//*[@id=&#x27;editNickname&#x27;]&quot;)))</span><br><span class="line"></span><br><span class="line">        assert user_name.text == &quot;熊熊工程師&quot;</span><br></pre></td></tr></table></figure>

<h1 id="建立測試目標"><a href="#建立測試目標" class="headerlink" title="建立測試目標"></a>建立測試目標</h1><ol>
<li>確認瀏覽器請求網址後的網址是否為 “<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/%22%EF%BC%8Ctitle">https://ithelp.ithome.com.tw/&quot;，title</a> 開頭是否為 “iT 邦幫忙”</li>
<li>確認請求 “<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/">https://ithelp.ithome.com.tw/</a>“ 後，網頁上是否有出現 “技術問答” 字樣，且 HTML tag 為 h2</li>
<li>確認請求 “<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/">https://ithelp.ithome.com.tw/</a>“ 後，網也上是否有出現 “技術問答”、”技術文章”… 等選項按鈕</li>
</ol>
<h1 id="建立-conftest-py"><a href="#建立-conftest-py" class="headerlink" title="建立 conftest.py"></a>建立 conftest.py</h1><p>在開始撰寫測試程式前，我們可以先撰寫 fixture 方便後續的測試進行，而由於 driver 確定是每個 test case 都會使用到的功能，因此我們將此 fixture 撰寫在 conftest.py 當中</p>
<p>conftest.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">from webdriver_manager.chrome import ChromeDriverManager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@pytest.fixture(name=&quot;driver&quot;)</span><br><span class="line">def driver_fixture() -&gt; Chrome:</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_argument(&quot;--headless&quot;)</span><br><span class="line">    options.add_argument(&quot;--start-maximized&quot;)</span><br><span class="line">    options.add_argument(f&quot;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) &quot;</span><br><span class="line">                         f&quot;AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36&quot;)</span><br><span class="line"></span><br><span class="line">    driver = Chrome(ChromeDriverManager().install(),</span><br><span class="line">                    options=options)</span><br><span class="line"></span><br><span class="line">    yield driver</span><br><span class="line"></span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure>
<h1 id="驗證-url-及-title"><a href="#驗證-url-及-title" class="headerlink" title="驗證 url 及 title"></a>驗證 url 及 title</h1><p>程式解析：</p>
<p>先對指定網址進行請求<br>驗證請求後跳轉的網址是否正確<br>驗證跳轉網址後的頁面的 title 是否開頭為 “iT 邦幫忙”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver import Chrome</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def test_current_url(driver: Chrome):</span><br><span class="line">    driver.get(&quot;https://ithelp.ithome.com.tw/&quot;)</span><br><span class="line"></span><br><span class="line">    correct_url = &quot;https://ithelp.ithome.com.tw/&quot;</span><br><span class="line">    assert driver.current_url == correct_url</span><br><span class="line"></span><br><span class="line">    correct_title_start = &quot;iT 邦幫忙&quot;</span><br><span class="line">    assert driver.title.startswith(correct_title_start)</span><br></pre></td></tr></table></figure>

<h1 id="驗證元素文字是否正確"><a href="#驗證元素文字是否正確" class="headerlink" title="驗證元素文字是否正確"></a>驗證元素文字是否正確</h1><p>程式解析：</p>
<p>建立測試資料<br>進行請求<br>透過 CSS_SELECTOR 找到元素<br>驗證該元素的 text 內容是否符合測試資料</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def test_text_visible(driver: Chrome):</span><br><span class="line">    correct_text = &quot;技術問答&quot;</span><br><span class="line"></span><br><span class="line">    driver.get(&quot;https://ithelp.ithome.com.tw/&quot;)</span><br><span class="line">    question_h2_element = driver.find_element(</span><br><span class="line">        By.CSS_SELECTOR, &quot;h2.tab-title&quot;)</span><br><span class="line"></span><br><span class="line">    assert question_h2_element.text == correct_text</span><br></pre></td></tr></table></figure>

<h1 id="驗證按鈕選項是否都有出現"><a href="#驗證按鈕選項是否都有出現" class="headerlink" title="驗證按鈕選項是否都有出現"></a>驗證按鈕選項是否都有出現</h1><p>程式解析：</p>
<p>建立測試資料<br>進行請求<br>透過 driver 先找到位於左方的選項列表元素 (ul)<br>在針對該元素尋找所有的選項內容 (li) 並透過 generator 的方式取得文字內容串列<br>文字內容串列是否符合正確的測試資料</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def test_element_clickable(driver: Chrome):</span><br><span class="line">    correct_options = [&quot;技術問答&quot;, &quot;技術文章&quot;, &quot;iT 徵才&quot;,</span><br><span class="line">                       &quot;Tag&quot;, &quot;聊天室&quot;, &quot;2022 鐵人賽&quot;]</span><br><span class="line"></span><br><span class="line">    driver.get(&quot;https://ithelp.ithome.com.tw/&quot;)</span><br><span class="line">    options = driver.find_element(</span><br><span class="line">        By.CSS_SELECTOR, &quot;ul.list-unstyled.menu__left&quot;)</span><br><span class="line">    options = [tmp.text for tmp in options.find_elements(</span><br><span class="line">        By.CSS_SELECTOR, &quot;li.menu__item&quot;)]</span><br><span class="line"></span><br><span class="line">    assert options == correct_options</span><br></pre></td></tr></table></figure>

<h1 id="安裝-Selenium-IDE"><a href="#安裝-Selenium-IDE" class="headerlink" title="安裝 Selenium IDE"></a>安裝 Selenium IDE</h1><ol>
<li>前往這個網址：<a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/selenium-ide/mooikfkahbdckldjjndioackbalphokd">https://chrome.google.com/webstore/detail/selenium-ide/mooikfkahbdckldjjndioackbalphokd</a></li>
<li>點選 “加到 Chrome” 選項</li>
<li>選擇 “新增擴充功能” 選項</li>
<li>過一陣子之後就可以在 Chrome 的右上角看到 Selenium IDE 被成功加入<br><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/upload/images/20221002/20144024nmnQrxsQAM.png">https://ithelp.ithome.com.tw/upload/images/20221002/20144024nmnQrxsQAM.png</a></li>
</ol>
<h1 id="介面介紹"><a href="#介面介紹" class="headerlink" title="介面介紹"></a>介面介紹</h1><h2 id="建立新專案"><a href="#建立新專案" class="headerlink" title="建立新專案"></a>建立新專案</h2><p>在開始介面介紹之前，我們先透過下面步驟建立一個簡單的測試計畫</p>
<ol>
<li>開啟 Selenium IDE</li>
<li>選擇 “Record a new test in a new project” 選項</li>
<li>輸入 project 名稱，範例使用 “demo”</li>
<li>輸入此測試計畫的目標網址，此處使用 <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/">https://ithelp.ithome.com.tw/</a></li>
<li>點選 “START RECORD” 選項開始進行錄製</li>
<li>點選該選項之後，就可以看到他幫我們開啟一個連覽器並且右下角有顯示 Recording 字樣</li>
</ol>
<p><img src="https://hackmd.io/_uploads/Syz_9ZFg6.png"></p>
<h2 id="介面介紹-1"><a href="#介面介紹-1" class="headerlink" title="介面介紹"></a>介面介紹</h2><p><img src="https://hackmd.io/_uploads/SkOqcZtla.png"></p>
<ol>
<li>project name：測試計畫名稱，我們可以透過命名計畫名稱來替測試分類</li>
<li>test 分類：分別有 Tests、Test Suites、Executing，此為 Selenium IDE，表示 Test 的部分</li>
<li>Tests：會列出所有 Test case</li>
<li>Test Suites：該計畫內部中的分類，預設會有 Default Suites 的存在</li>
<li>Executing：目前正在執行測試的 test case 會出現在此分類</li>
<li>test case 列表：依照　test 分類顯示出對應的 test case</li>
<li>指令列表：列出該 test case 當中所有的指令，並會依照順序進行執行</li>
<li>編輯指令：每個指令都可以透過這個視窗進行編輯、更換</li>
<li>存檔</li>
<li>錄製按鈕：按下此按鈕後會開啟瀏覽器並進行錄製</li>
</ol>
<h2 id="錄製腳本展示"><a href="#錄製腳本展示" class="headerlink" title="錄製腳本展示"></a>錄製腳本展示</h2><p>我們可以透過錄製腳本的方式來進行測試案例的建立，也可以透過手動插入腳本的方式進行建立，不過在驗證的部分一定是透過手動插入的，Selenium IDE 只能協助我們錄製在我們想驗證的元素出現之前該進行甚麼樣的動作</p>
<p>另外經過筆者實測，建議在開始錄製之前都手動插入一行 open 命令來開啟網址，在錄製的過程中會比較順暢，下面我們就簡單錄製一個腳本給大家看</p>
<h3 id="腳本說明"><a href="#腳本說明" class="headerlink" title="腳本說明"></a>腳本說明</h3><p>我們會按照下面的步驟來進行腳本的錄製：</p>
<ol>
<li>開啟　<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/">https://ithelp.ithome.com.tw/</a></li>
<li>放大瀏覽器畫面</li>
<li>點選 “技術文章”</li>
<li>驗證 “h2 技術文章” 元素是否有出現</li>
</ol>
<h3 id="腳本展示"><a href="#腳本展示" class="headerlink" title="腳本展示"></a>腳本展示</h3><ol>
<li>點選紅色方框按鈕可以進行單個測試程式測試，左方按鈕為執行所有測試程式</li>
<li>建議於錄製完成後，都將第一行 open 指令中的 “Target” 修改成想要到達的網址，避免造成錯誤</li>
</ol>
<p><img src="https://hackmd.io/_uploads/Bkq1jbtlp.png"></p>
<h3 id="驗證方式"><a href="#驗證方式" class="headerlink" title="驗證方式"></a>驗證方式</h3><p>這個部分會說明一些常用的驗證項目，也就是 assert 的選項</p>
<ul>
<li>assert alert：驗證是否有跳出提示視窗</li>
<li>assert element present：驗證元素是否有出現</li>
<li>assert element not present：驗證元素是否沒出現</li>
<li>assert text：驗證元素文字是否為指定的數值</li>
<li>assert not text：驗證元素是否不為指定的數值</li>
</ul>
<h3 id="輸出為-Python-腳本"><a href="#輸出為-Python-腳本" class="headerlink" title="輸出為 Python 腳本"></a>輸出為 Python 腳本</h3><h4 id="輸出步驟"><a href="#輸出步驟" class="headerlink" title="輸出步驟"></a>輸出步驟</h4><p>透過下面的方式可以將錄製好的腳本輸出為 Python 以及其他語言的腳本，然後就可以交給測試部門的 RD 進行程式的重構或使用，進一步套入 CI&#x2F;CD 進行自動化測試</p>
<p>回到 Tests 分類</p>
<p>點選要匯出的測試案例旁邊的三個按鈕<br><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/upload/images/20221002/20144024nOaNk5J8ye.jpg">https://ithelp.ithome.com.tw/upload/images/20221002/20144024nOaNk5J8ye.jpg</a></p>
<p>選擇 “EXPORT” 選項</p>
<p>選擇 “Python pytest” 選項</p>
<p>選擇 “EXPORT” 選項</p>
<h4 id="腳本展示-1"><a href="#腳本展示-1" class="headerlink" title="腳本展示"></a>腳本展示</h4><p>透過 Selenium IDE 所輸出的 Python 腳本，可以直接執行，不如果要套入 CI&#x2F;CD，或是公司本身自有的測試框架或其他種類流程的話，<br>都會需要進行某種程度上的重構，這時後錄製腳本的人員如果沒有程式相關背景的話，就可以交給 RD 進行重構並納入自動化測試當中，<br>或本身是測試部門的 RD 的話，也可以透過這個小工具來減少我們寫 code 的時間，獲取更多偷懶的機會</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># Generated by Selenium IDE</span><br><span class="line">import pytest</span><br><span class="line">import time</span><br><span class="line">import json</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">from selenium.webdriver.common.action_chains import ActionChains</span><br><span class="line">from selenium.webdriver.support import expected_conditions</span><br><span class="line">from selenium.webdriver.support.wait import WebDriverWait</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">from selenium.webdriver.common.desired_capabilities import DesiredCapabilities</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class TestDemo():</span><br><span class="line">    def setup_method(self, method):</span><br><span class="line">        self.driver = webdriver.Chrome()</span><br><span class="line">        self.vars = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    def teardown_method(self, method):</span><br><span class="line">        self.driver.quit()</span><br><span class="line"></span><br><span class="line">    def test_demo(self):</span><br><span class="line">        self.driver.get(&quot;https://ithelp.ithome.com.tw/&quot;)</span><br><span class="line">        self.driver.set_window_size(1552, 832)</span><br><span class="line">        self.driver.find_element(By.LINK_TEXT, &quot;技術文章&quot;).click()</span><br><span class="line">        elements = self.driver.find_elements(By.XPATH, &quot;//h2[contains(.,\&#x27;技術文章\&#x27;)]&quot;)</span><br><span class="line">        assert len(elements) &gt; 0</span><br><span class="line">        self.driver.close()</span><br></pre></td></tr></table></figure>

<h1 id="XPATH"><a href="#XPATH" class="headerlink" title="XPATH"></a>XPATH</h1><h2 id="建立-driver-函式-2"><a href="#建立-driver-函式-2" class="headerlink" title="建立 driver 函式"></a>建立 driver 函式</h2><p>這邊就不再贅述，直接上範例，唯一不一樣的地方是，在這個階段我們會直接開啟指定的 url 再將 driver 回傳</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from contextlib import contextmanager</span><br><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">from webdriver_manager.chrome import ChromeDriverManager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@contextmanager</span><br><span class="line">def make_chrome_driver() -&gt; Chrome:</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_argument(&quot;--headless&quot;)</span><br><span class="line">    options.add_argument(&quot;--start-maximized&quot;)</span><br><span class="line">    options.add_argument(f&quot;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) &quot;</span><br><span class="line">                         f&quot;AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36&quot;)</span><br><span class="line"></span><br><span class="line">    driver = Chrome(ChromeDriverManager().install(),</span><br><span class="line">                    options=options)</span><br><span class="line">    driver.get(&quot;https://ithelp.ithome.com.tw/questions&quot;)</span><br><span class="line">    yield driver</span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure>
<h2 id="相對位置-XPATH"><a href="#相對位置-XPATH" class="headerlink" title="相對位置 XPATH"></a>相對位置 XPATH</h2><p>在 selenium 當中，我們可以透過相對位置的 XPATH 來定位我們的元素，語法結構大致如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xpath = &quot;//div[@class=&#x27;board tabs-content&#x27;]/div[1]&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x2F;&#x2F;：表示當前網頁 or 元素</li>
<li>div：要尋找的 HTML tag</li>
<li>[]：為 XPATH 的運算邏輯，在裡面可以增加 class、id 甚至是 and 等條件，語法為 “@&lt;屬性名稱&gt;”，ex: @class、@id、@name…</li>
<li>div[1]：同層級且同樣的元素可能會有很多個，例如：ithelp 問答葉面的問題列表，可以透過取串列的方式來取得指定的個數，若沒有預設為取得第一個找到符合條件的元素</li>
</ul>
<p>上述的 XPATH 語法代表要取得 “class 為 board tabs-content 的 div” 底下的 “第一個 div”</p>
<p>範例程式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_question_by_relative_xpath():</span><br><span class="line">    with make_chrome_driver() as driver:</span><br><span class="line">        xpath = &quot;//div[@class=&#x27;board tabs-content&#x27;]/div[1]&quot;</span><br><span class="line">        question = driver.find_element(By.XPATH, xpath)</span><br><span class="line">        print(question.text)</span><br></pre></td></tr></table></figure>
<p>執行結果：<br><img src="https://hackmd.io/_uploads/ryik6btlp.png"></p>
<h2 id="取得多個元素"><a href="#取得多個元素" class="headerlink" title="取得多個元素"></a>取得多個元素</h2><p>當你找元素時使用的是 driver.find_elements，XPATH 會協助你將所有符合條件的元素都蒐集回來，下方的範例當中就成功將問答頁面第一頁中所有的問題都爬娶回來並印出數量</p>
<p>範例程式：</p>
<p>可以看到下方範例當中，我們將最後面的 div[1] 取代為 div[@class&#x3D;’qa-list’]，表示我們要在這一層取得所有 “class 為 qa-list的 div”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_questions_by_relative_xpath():</span><br><span class="line">    with make_chrome_driver() as driver:</span><br><span class="line">        xpath = &quot;//div[@class=&#x27;board tabs-content&#x27;]/div[@class=&#x27;qa-list&#x27;]&quot;</span><br><span class="line">        questions = driver.find_elements(By.XPATH, xpath)</span><br><span class="line">        print(len(questions))</span><br></pre></td></tr></table></figure>

<p>執行結果：<br><img src="https://hackmd.io/_uploads/S1QMaWYx6.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://gahgah147.github.io">Nalson Lai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章連結: </span><span class="post-copyright-info"><a href="https://gahgah147.github.io/2023/10/03/Selenium-%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6/">https://gahgah147.github.io/2023/10/03/Selenium-%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版權聲明: </span><span class="post-copyright-info">本部落格所有文章除特別聲明外，均採用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 授權協議。轉載請註明來源 <a href="https://gahgah147.github.io" target="_blank">Nalson</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6/">自動化測試</a><a class="post-meta__tags" href="/tags/Selenium/">Selenium</a><a class="post-meta__tags" href="/tags/XPATH/">XPATH</a></div><div class="post-share"><div class="social-share" data-image="/img/catchorange.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2023/10/16/Docker-%E5%AE%B9%E5%99%A8%E6%93%8D%E4%BD%9C/" title="Docker 基本操作 - 進入容器"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Docker 基本操作 - 進入容器</div></div><div class="info-2"><div class="info-item-1">Docker 進入容器  以下文章是在使用 Docker 時查詢到的好文章 我覺得這篇記錄的很詳細，所以記錄一下 exec 命令docker exec 是Docker內建的命令。下面示範如何使用該命令。 1234567$ sudo docker run -idt ubuntu243c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550$ sudo docker psCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES243c32535da7        ubuntu:latest       &quot;/bin/bash&quot;         18 seconds ago      Up 17 seconds                           nostalgic_hypatia$sudo...</div></div></div></a><a class="pagination-related" href="/2023/10/02/TDD-%E6%B8%AC%E8%A9%A6%E9%A9%85%E5%8B%95%E9%96%8B%E7%99%BC%E6%B5%81%E7%A8%8B/" title="TDD 測試驅動開發流程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">TDD 測試驅動開發流程</div></div><div class="info-2"><div class="info-item-1">這篇是記錄我在看鐵人賽 Python 與自動化測試的敲門磚  的過程 TDD 簡介TDD 全名為 Test-Driven Development 中文翻譯為 「測試驅動開發」，顧名思義就是藉著撰寫測試程式，來一步一步建構出我們的系統，其倡導的概念為，先撰寫測試程式，再撰寫實際相對應的 function，因此程式開發者需要先行和 PM 或使用者討論系統需求，並逐步擬定測試計畫，最後才會真正開始撰寫程式 採用 TDD 開發的優缺點    好處 壞處    無須事後再補寫測試程式 若系統需求溝通不良，會容易造成系統設計不良   每一位 RD 都可以透過測試程式了解每個 function 的內容，較容易熟悉系統 測試程式有很大的機率只有 RD 部門看得懂，需要花費多於成本溝通   可以確保每個 function 被更動時，可以馬上進行測試，降低錯誤產生    3A 原則在 TDD 當中，對於每個測試程式的撰寫有著 3A 原則 (步驟)，分別為 Arrange、Act 以及 Assert，下面按照順序來進行說明 下面這段程式碼是我們在 demo 3A...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相關推薦</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2023/09/22/Pytest-%E8%87%AA%E5%8B%95%E6%B8%AC%E8%A9%A6/" title="Pytest 自動測試"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-22</div><div class="info-item-2">Pytest 自動測試</div></div><div class="info-2"><div class="info-item-1">Pytest 指令1pytest &lt;.py 檔案位置&gt; 範例：pytest .\day_03\test_demo.py 參數執行1.列出每個 test case 的執行狀況 1pytest -v &lt;目錄 or 檔案位置&gt;  2.會印出在 test case 內有 print 出來的數值 1pytest -s &lt;目錄 or 檔案位置&gt;  3.不同的參數間，也可以進行混用，這邊進行簡單的範例展示 1pytest -s -v &lt;目錄 or 檔案位置&gt;：  產生報表產出 JSON 格式報表安裝 pytest-json-report 套件1pip install pytest-json-report   套件使用1pytest &lt;pytest 原生參數 ex: -s -v&gt; --json-report --json-report-file=&lt;檔案名稱 or ./目錄位置/檔案名稱&gt; &lt;要執行的 .py 檔案 (可省略直接對整個目錄做讀取)&gt; 使用範例：pytest -s -v –json-report...</div></div></div></a><a class="pagination-related" href="/2023/09/21/Python-%E8%88%87%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6/" title="Python 與自動化測試"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-21</div><div class="info-item-2">Python 與自動化測試</div></div><div class="info-2"><div class="info-item-1">前言這篇是記錄我在看鐵人賽 Python 與自動化測試的敲門磚  的過程 主題   主題 日程    簡介 day 01   Pytest day 02 ~ 10   TDD day 11 ~ 12   Selenium day 13 ~ 17   Appium day 18 ~ 21   CI&#x2F;CD day 22 ~ 26   Jenkins day 27 ~ 29   結語 day 30   PytestPytest 是一種使用在 Python 語言裡面的一中單元測試框架，而 Pytest 基本上就是由 Python 原生自帶的單元測試框架 Unittest 衍生出來的，所以可以看到有些範例可以和 Unittest 的套件互相兼容混用。 Pytest 和 Unittest 相比，有下列幾項優點：  更易於上手，撰寫 testcase 時較為直覺 擴展性高，可以兼容許多外掛套件 可以標註某些 testcase 為失敗是正常的 測試程式撰寫起來相較於 unittest 較為簡潔  TDDTDD 完整名稱為 Test-driven development，中譯為...</div></div></div></a><a class="pagination-related" href="/2023/11/27/Python-%E7%B6%B2%E9%A0%81%E6%9C%8D%E5%8B%99%E9%96%8B%E7%99%BC%E7%9A%84-UX-%E8%88%87-DX-%E6%AF%94%E8%BC%83/" title="Python 網頁服務開發的 UX 與 DX 比較"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-27</div><div class="info-item-2">Python 網頁服務開發的 UX 與 DX 比較</div></div><div class="info-2"><div class="info-item-1">這篇文章是我在 Agoda Engineering 部落格的文章閱讀紀錄UX vs. DX in Python Web Servers UX vs. DX in Python Web ServersAgoda在11月舉辦了一場與曼谷Python社群合作的ThaiPy聚會。演講者是Agoda的高級軟體工程師Mohamad Kamar，他分享了有關“Python Web伺服器中的UX vs DX”的演講。他深入探討了Python在Web伺服器架構方面的多樣性，從簡單的同步伺服器到複雜的異步和基於框架的伺服器。這篇博客文章總結了演講中討論的要點。 什麼是 UX and DX...</div></div></div></a><a class="pagination-related" href="/2023/10/02/TDD-%E6%B8%AC%E8%A9%A6%E9%A9%85%E5%8B%95%E9%96%8B%E7%99%BC%E6%B5%81%E7%A8%8B/" title="TDD 測試驅動開發流程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-02</div><div class="info-item-2">TDD 測試驅動開發流程</div></div><div class="info-2"><div class="info-item-1">這篇是記錄我在看鐵人賽 Python 與自動化測試的敲門磚  的過程 TDD 簡介TDD 全名為 Test-Driven Development 中文翻譯為 「測試驅動開發」，顧名思義就是藉著撰寫測試程式，來一步一步建構出我們的系統，其倡導的概念為，先撰寫測試程式，再撰寫實際相對應的 function，因此程式開發者需要先行和 PM 或使用者討論系統需求，並逐步擬定測試計畫，最後才會真正開始撰寫程式 採用 TDD 開發的優缺點    好處 壞處    無須事後再補寫測試程式 若系統需求溝通不良，會容易造成系統設計不良   每一位 RD 都可以透過測試程式了解每個 function 的內容，較容易熟悉系統 測試程式有很大的機率只有 RD 部門看得懂，需要花費多於成本溝通   可以確保每個 function 被更動時，可以馬上進行測試，降低錯誤產生    3A 原則在 TDD 當中，對於每個測試程式的撰寫有著 3A 原則 (步驟)，分別為 Arrange、Act 以及 Assert，下面按照順序來進行說明 下面這段程式碼是我們在 demo 3A...</div></div></div></a><a class="pagination-related" href="/2023/09/12/%E5%9C%A8Codespace-%E4%B8%8A%E9%81%8B%E8%A1%8CPython/" title="在Codespace 上運行Python"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-12</div><div class="info-item-2">在Codespace 上運行Python</div></div><div class="info-2"><div class="info-item-1">在Codespace 上運行Python範例原始碼放在 GitHub Repo: vscode-remote-try-python 參考文章:Setting up a Python project for GitHub Codespaces 1. 在 codespace 上開啟 projectGo to https://github.com/microsoft/vscode-remote-try-python.Click Use this template, then    點擊 Open in a codespace.  2: 新增 dev container 設定檔案1.使用 Visual Studio Code 指令 (Ctrl+Shift+P&#x2F;Shift+Command+P)，然後輸入 add dev    點擊 Codespaces: Add Dev Container Configuration Files.   點擊 Create a new...</div></div></div></a><a class="pagination-related" href="/2023/10/27/pytest-sugar-%E6%B8%AC%E8%A9%A6%E8%BC%B8%E5%87%BA%E7%BE%8E%E5%8C%96%E8%88%87%E9%9A%A8%E6%A9%9F%E6%B8%AC%E8%A9%A6/" title="pytest-sugar 測試輸出美化與隨機測試"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-27</div><div class="info-item-2">pytest-sugar 測試輸出美化與隨機測試</div></div><div class="info-2"><div class="info-item-1">今天我們要介紹該如何美化我們在進行測試時終端機的輸出，以及讓我們的測試可以隨機的進行 測試輸出美化套件安裝1pip install pytest-sugar  測試案例下方為本次會使用到的測試案例，透過參數化的方式建立四次測試 12345678910111213import pytestargvalues = [[1, 1, 2], [4, 4, 8]]@pytest.mark.parametrize(argnames=&#x27;num1, num2, result&#x27;, argvalues=argvalues)def test_add(num1: int, num2: int, result: int):    assert num1 + num2 == result@pytest.mark.parametrize(argnames=&#x27;num1, num2, result&#x27;, argvalues=argvalues)def example_add(num1: int, num2: int, result: int):    assert num1...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 評論</span></div><div class="comment-switch"><span class="first-comment">Valine</span><span id="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/catchorange.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Nalson Lai</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">134</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">215</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/gahgah147"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/gahgah147" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">在哪裡跌倒<br>就在哪裡躺好</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目錄</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A5%97%E4%BB%B6%E5%AE%89%E8%A3%9D"><span class="toc-number">1.</span> <span class="toc-text">套件安裝</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%85%A5%E9%96%80"><span class="toc-number">2.</span> <span class="toc-text">快速入門</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%A0%E4%B8%8A%E5%8F%83%E6%95%B8"><span class="toc-number">3.</span> <span class="toc-text">加上參數</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%90%AD%E9%85%8D-fixture"><span class="toc-number">4.</span> <span class="toc-text">搭配 fixture</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-driver-%E5%87%BD%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">建立 driver 函式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-CSS-SELECTOR-%E5%AE%9A%E4%BD%8D"><span class="toc-number">6.</span> <span class="toc-text">使用 CSS_SELECTOR 定位</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-XPATH-%E5%AE%9A%E4%BD%8D"><span class="toc-number">7.</span> <span class="toc-text">使用 XPATH 定位</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AD%89%E5%BE%85%E5%85%83%E7%B4%A0%E5%87%BA%E7%8F%BE"><span class="toc-number">8.</span> <span class="toc-text">等待元素出現</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-driver-%E5%87%BD%E5%BC%8F-1"><span class="toc-number">9.</span> <span class="toc-text">建立 driver 函式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%96%E5%BE%97%E5%9F%BA%E6%9C%AC%E8%B3%87%E8%A8%8A"><span class="toc-number">10.</span> <span class="toc-text">取得基本資訊</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%BB%9E%E9%81%B8%E5%85%83%E7%B4%A0"><span class="toc-number">11.</span> <span class="toc-text">點選元素</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Selenium-%E9%BB%9E%E9%81%B8"><span class="toc-number">11.1.</span> <span class="toc-text">使用 Selenium 點選</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Javascript-%E9%BB%9E%E9%81%B8"><span class="toc-number">11.2.</span> <span class="toc-text">使用 Javascript 點選</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%8D%B5%E7%9B%A4%E6%93%8D%E4%BD%9C"><span class="toc-number">12.</span> <span class="toc-text">鍵盤操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E6%B8%AC%E8%A9%A6%E7%9B%AE%E6%A8%99"><span class="toc-number">13.</span> <span class="toc-text">建立測試目標</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-conftest-py"><span class="toc-number">14.</span> <span class="toc-text">建立 conftest.py</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A9%97%E8%AD%89-url-%E5%8F%8A-title"><span class="toc-number">15.</span> <span class="toc-text">驗證 url 及 title</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A9%97%E8%AD%89%E5%85%83%E7%B4%A0%E6%96%87%E5%AD%97%E6%98%AF%E5%90%A6%E6%AD%A3%E7%A2%BA"><span class="toc-number">16.</span> <span class="toc-text">驗證元素文字是否正確</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A9%97%E8%AD%89%E6%8C%89%E9%88%95%E9%81%B8%E9%A0%85%E6%98%AF%E5%90%A6%E9%83%BD%E6%9C%89%E5%87%BA%E7%8F%BE"><span class="toc-number">17.</span> <span class="toc-text">驗證按鈕選項是否都有出現</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%9D-Selenium-IDE"><span class="toc-number">18.</span> <span class="toc-text">安裝 Selenium IDE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8B%E9%9D%A2%E4%BB%8B%E7%B4%B9"><span class="toc-number">19.</span> <span class="toc-text">介面介紹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E6%96%B0%E5%B0%88%E6%A1%88"><span class="toc-number">19.1.</span> <span class="toc-text">建立新專案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E9%9D%A2%E4%BB%8B%E7%B4%B9-1"><span class="toc-number">19.2.</span> <span class="toc-text">介面介紹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%8C%84%E8%A3%BD%E8%85%B3%E6%9C%AC%E5%B1%95%E7%A4%BA"><span class="toc-number">19.3.</span> <span class="toc-text">錄製腳本展示</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%85%B3%E6%9C%AC%E8%AA%AA%E6%98%8E"><span class="toc-number">19.3.1.</span> <span class="toc-text">腳本說明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%85%B3%E6%9C%AC%E5%B1%95%E7%A4%BA"><span class="toc-number">19.3.2.</span> <span class="toc-text">腳本展示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A9%97%E8%AD%89%E6%96%B9%E5%BC%8F"><span class="toc-number">19.3.3.</span> <span class="toc-text">驗證方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BC%B8%E5%87%BA%E7%82%BA-Python-%E8%85%B3%E6%9C%AC"><span class="toc-number">19.3.4.</span> <span class="toc-text">輸出為 Python 腳本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BC%B8%E5%87%BA%E6%AD%A5%E9%A9%9F"><span class="toc-number">19.3.4.1.</span> <span class="toc-text">輸出步驟</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%85%B3%E6%9C%AC%E5%B1%95%E7%A4%BA-1"><span class="toc-number">19.3.4.2.</span> <span class="toc-text">腳本展示</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XPATH"><span class="toc-number">20.</span> <span class="toc-text">XPATH</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-driver-%E5%87%BD%E5%BC%8F-2"><span class="toc-number">20.1.</span> <span class="toc-text">建立 driver 函式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%B0%8D%E4%BD%8D%E7%BD%AE-XPATH"><span class="toc-number">20.2.</span> <span class="toc-text">相對位置 XPATH</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%96%E5%BE%97%E5%A4%9A%E5%80%8B%E5%85%83%E7%B4%A0"><span class="toc-number">20.3.</span> <span class="toc-text">取得多個元素</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/02/02/Claude-Code-%E5%AE%98%E6%96%B9%E6%8E%A8%E5%87%BA-Playground-Skill-%E5%BF%AB%E9%80%9F%E5%89%B5%E5%BB%BA%E6%96%B9%E4%BE%BF%E7%B5%A6-AI-%E8%AE%80%E5%8F%96%E7%9A%84%E4%BA%92%E5%8B%95%E5%BC%8F-HTML-%E5%B7%A5%E5%85%B7/" title="Claude Code 官方推出 Playground Skill 快速創建方便給 AI 讀取的互動式 HTML 工具"><img src="https://hackmd.io/_uploads/S1vJzi6LZl.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Claude Code 官方推出 Playground Skill 快速創建方便給 AI 讀取的互動式 HTML 工具"/></a><div class="content"><a class="title" href="/2026/02/02/Claude-Code-%E5%AE%98%E6%96%B9%E6%8E%A8%E5%87%BA-Playground-Skill-%E5%BF%AB%E9%80%9F%E5%89%B5%E5%BB%BA%E6%96%B9%E4%BE%BF%E7%B5%A6-AI-%E8%AE%80%E5%8F%96%E7%9A%84%E4%BA%92%E5%8B%95%E5%BC%8F-HTML-%E5%B7%A5%E5%85%B7/" title="Claude Code 官方推出 Playground Skill 快速創建方便給 AI 讀取的互動式 HTML 工具">Claude Code 官方推出 Playground Skill 快速創建方便給 AI 讀取的互動式 HTML 工具</a><time datetime="2026-02-02T04:01:46.000Z" title="發表於 2026-02-02 12:01:46">2026-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/21/%E4%BD%BF%E7%94%A8-OpenAI-Codex-%E8%87%AA%E5%8B%95%E5%8C%96%E5%AF%A9%E6%9F%A5%E7%A8%8B%E5%BC%8F%E7%A2%BC%E3%80%81%E6%8F%90%E5%8D%87%E9%96%8B%E7%99%BC%E5%93%81%E8%B3%AA%E7%9A%84%E5%AF%A6%E9%9A%9B%E6%93%8D%E4%BD%9C/" title="使用 OpenAI Codex 自動化審查程式碼、提升開發品質的實際操作">使用 OpenAI Codex 自動化審查程式碼、提升開發品質的實際操作</a><time datetime="2025-11-21T06:21:50.000Z" title="發表於 2025-11-21 14:21:50">2025-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/19/%F0%9F%9A%80-%E5%88%9D%E5%AD%B8%E8%80%85%E4%B9%9F%E8%83%BD%E6%87%82%E7%9A%84-Cloud-Run-CI-CD%EF%BC%9A%E6%8A%8A%E7%A8%8B%E5%BC%8F%E8%AE%8A%E6%88%90%E4%B8%80%E5%80%8B%E7%B6%B2%E5%9D%80/" title="🚀 初學者也能懂的 Cloud Run CI/CD：把程式變成一個網址"><img src="https://hackmd.io/_uploads/Sk5xYt9oxe.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="🚀 初學者也能懂的 Cloud Run CI/CD：把程式變成一個網址"/></a><div class="content"><a class="title" href="/2025/09/19/%F0%9F%9A%80-%E5%88%9D%E5%AD%B8%E8%80%85%E4%B9%9F%E8%83%BD%E6%87%82%E7%9A%84-Cloud-Run-CI-CD%EF%BC%9A%E6%8A%8A%E7%A8%8B%E5%BC%8F%E8%AE%8A%E6%88%90%E4%B8%80%E5%80%8B%E7%B6%B2%E5%9D%80/" title="🚀 初學者也能懂的 Cloud Run CI/CD：把程式變成一個網址">🚀 初學者也能懂的 Cloud Run CI/CD：把程式變成一個網址</a><time datetime="2025-09-19T09:31:07.000Z" title="發表於 2025-09-19 17:31:07">2025-09-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/07/%F0%9F%92%A1-%E9%81%BF%E5%85%8D-Cursor-%E5%8D%A1%E9%A0%93%EF%BC%81%E8%A6%81%E8%A8%AD%E5%AE%9A-cursorignore-%E6%8F%90%E5%8D%87%E6%95%88%E8%83%BD/" title="💡 避免 Cursor 卡頓！要設定 .cursorignore 提升效能">💡 避免 Cursor 卡頓！要設定 .cursorignore 提升效能</a><time datetime="2025-08-07T07:29:52.000Z" title="發表於 2025-08-07 15:29:52">2025-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/24/%F0%9F%9A%80-GKE-Cloud-SQL-Proxy-GitHub-Actions-%E5%AE%8C%E6%95%B4-CI-CD-%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8/" title="🚀 GKE + Cloud SQL Proxy + GitHub Actions 完整 CI/CD 實戰教學">🚀 GKE + Cloud SQL Proxy + GitHub Actions 完整 CI/CD 實戰教學</a><time datetime="2025-06-24T01:01:38.000Z" title="發表於 2025-06-24 09:01:38">2025-06-24</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2026 By Nalson Lai</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主題 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日夜模式切換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往評論"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到頂端"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.1.0"></script><script src="/js/main.js?v=5.1.0"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.3.0/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine@1.5.2/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !true) {
    if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><script>(() => {
  const disqus_config = function () {
    this.page.url = 'https://gahgah147.github.io/2023/10/03/Selenium-%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6/'
    this.page.identifier = '/2023/10/03/Selenium-%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6/'
    this.page.title = 'Selenium 自動化測試'
  }

  const disqusReset = () => {
    window.DISQUS && window.DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addGlobalFn('themeChange', disqusReset, 'disqus')

  const loadDisqus = () =>{
    if (window.DISQUS) disqusReset()
    else {
      const script = document.createElement('script')
      script.src = 'https://.disqus.com/embed.js'
      script.setAttribute('data-timestamp', +new Date())
      document.head.appendChild(script)
    }
  }

  const getCount = async() => {
    try {
      const eleGroup = document.querySelector('#post-meta .disqus-comment-count')
      if (!eleGroup) return
      const cleanedLinks = eleGroup.href.replace(/#post-comment$/, '')

      const res = await fetch(`https://disqus.com/api/3.0/threads/set.json?forum=&api_key=&thread:link=${cleanedLinks}`,{
        method: 'GET'
      })
      const result = await res.json()

      const count = result.response.length ? result.response[0].posts : 0
      eleGroup.textContent = count
    } catch (err) {
      console.error(err)
    }
  }

  if ('Valine' === 'Disqus' || !true) {
    if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
    else {
      loadDisqus()
      GLOBAL_CONFIG_SITE.isPost && getCount()
    }
  } else {
    window.loadOtherComment = loadDisqus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜尋</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  資料載入中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜尋文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.1.0"></script></div></div></body></html>